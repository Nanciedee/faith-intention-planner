// FONCTION : Exporter les données vers un fichier JSON
function exportData() {
    try {
        const dataStr = JSON.stringify(state, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        const date = new Date().toISOString().split('T')[0];
        
        link.download = `Journal_Faith_2026_${date}.json`;
        link.href = url;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    } catch (err) {
        alert("Erreur lors de l'exportation : " + err);
    }
}

// FONCTION : Importer les données depuis un fichier JSON
function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    input.onchange = e => {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = event => {
            try {
                const importedData = JSON.parse(event.target.result);
                
                // Confirmation avant d'écraser
                if (confirm("Voulez-vous remplacer vos données actuelles par celles de ce fichier ?")) {
                    state = importedData;
                    save(); // Sauvegarde dans le LocalStorage
                    showPage('cover'); // Rafraîchit l'affichage
                    alert("Journal chargé avec succès !");
                }
            } catch (err) {
                alert("Erreur : Le fichier n'est pas un journal valide.");
            }
        };
        reader.readAsText(file);
    };
    input.click();
}
